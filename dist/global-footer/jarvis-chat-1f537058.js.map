{"version":3,"file":"jarvis-chat-1f537058.js","sources":["../../libs/features/jarvis-chat.js"],"sourcesContent":["let chatInitialized = false;\nlet loadScript;\nlet loadStyle;\nlet getMetadata;\n\nconst isSilentEvent = (data) => (data['event.workflow'] === 'init' && data['event.type'] === 'request')\n  || (data['event.workflow'] === 'Chat' && data['event.type'] === 'load' && data['event.subtype'] === 'window');\n\nconst getBaseEvent = (data) => ({\n  chatConversationId: data['event.context_guid'],\n  chatConversationSessionId: data['event.session_guid'],\n  chatWorkflow: data['event.workflow'],\n  chatCategory: data['event.category'],\n  chatSubcategory: data['event.subcategory'],\n  chatType: data['event.type'],\n  chatSubtype: data['event.subtype'],\n  chatUserguid: data['event.user_guid'],\n  chatLanguage: data['event.language'],\n  chatPagename: data['event.pagename'],\n  chatVisitorguid: data['event.visitor_guid'],\n  chatUrl: data['event.url'],\n  chatOrgguid: data['event.org_guid'],\n  chatReferrer: data['event.referrer'],\n  chatClientId: data['source.client_id'],\n  chatSourceName: data['source.name'],\n  chatPlatform: data['source.platform'],\n  chatContentName: data['content.name'],\n  chatEnv: data['env.com.name'],\n});\n\nconst setSophiaLayer = (data) => {\n  const sophiaData = {\n    variationId: data['exp.variation_id'],\n    actionBlockId: data['exp.action_block_id'],\n    campaignId: data['exp.campaign_id'],\n    containerId: data['exp.container_id'],\n    controlGroupId: data['exp.control_group_id'],\n    treatmentId: data['exp.treatment_id'],\n    surfaceId: data['exp.surface_id'],\n  };\n\n  Object.keys(sophiaData).forEach((key) => {\n    if (!sophiaData[key]) delete sophiaData[key];\n  });\n  if (!Object.keys(sophiaData).length) return;\n\n  const sophiaDataCaptured = (id) => {\n    let captured = false;\n    if (!id) return captured;\n\n    const sophiaDataLayer = window.digitalData.sophiaResponse?.fromPage;\n    if (Array.isArray(sophiaDataLayer)) {\n      captured = sophiaDataLayer.some((sophiaEvent) => sophiaEvent?.campaignId === id);\n    } else {\n      captured = (sophiaDataLayer?.campaignId === id);\n    }\n\n    return captured;\n  };\n\n  if (sophiaDataCaptured(sophiaData.campaignId)) return;\n\n  window.digitalData.sophiaResponse ||= {};\n  window.digitalData.sophiaResponse.fromPage ||= [];\n\n  if (Array.isArray(window.digitalData.sophiaResponse.fromPage)) {\n    window.digitalData.sophiaResponse.fromPage.push(sophiaData);\n  } else {\n    window.digitalData.sophiaResponse.fromPage = sophiaData;\n  }\n};\n\nconst sendEvent = (data) => {\n  setSophiaLayer(data);\n  // eslint-disable-next-line no-underscore-dangle\n  window._satellite?.track('event', {\n    xdm: {},\n    data: {\n      web: { webInteraction: { name: window.digitalData.primaryEvent?.eventInfo?.eventName } },\n      _adobe_corpnew: {\n        digitalData: {\n          primaryEvent: window.digitalData.primaryEvent,\n          chat: window.digitalData.chat,\n          sophiaResponse: window.digitalData.sophiaResponse,\n        },\n      },\n    },\n  });\n};\n\nconst getDataProperties = (data, properties = []) => properties.reduce((str, prop) => {\n  let output = str;\n  output += `${output && ':'}${data[prop] || ''}`;\n  return output;\n}, '');\n\nconst sendChatIconRenderEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'event.subcategory', 'event.subtype', 'content.name', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n  window.digitalData.chat.chatInfo.chatConversationUnread = data['content.name'];\n\n  sendEvent(data);\n};\n\nconst sendChatIconClickEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'event.subcategory', 'event.subtype', 'content.name', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'event.subtype', 'content.name', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n  window.digitalData.chat.chatInfo.chatConversationUnread = data['content.name'];\n\n  sendEvent(data);\n};\n\nconst sendProductEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'content.name', 'event.subtype', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.subtype', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = { chatInfo: { primaryProduct: { productName: data['event.subtype'] } } };\n\n  sendEvent(data);\n};\n\nconst sendSurveyFeedbackEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'content.name', 'event.subtype', 'event.type', 'content.id'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.subtype', 'event.type']),\n    },\n  };\n\n  sendEvent(data);\n};\n\nconst sendChatErrorEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'event.subtype', 'event.type'])}:error`,\n      eventAction: `${getDataProperties(data, ['event.subcategory', 'event.subtype', 'event.type'])}:error`,\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n  window.digitalData.chat.chatInfo.chatErrorCode = data['event.error_code'];\n  window.digitalData.chat.chatInfo.chatErrorType = data['event.error_type'];\n  window.digitalData.chat.chatInfo.chatErrorDescription = data['event.error_desc'];\n\n  sendEvent(data);\n};\n\nconst sendPrimaryEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'content.name', 'event.subtype', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.subtype', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n\n  sendEvent(data);\n};\n\nconst redirectToSupport = () => window.location.assign('https://helpx.adobe.com');\n\nconst isChatOpen = () => {\n  const instance = window.AdobeMessagingExperienceClient;\n  return instance?.isAdobeMessagingClientInitialized()\n    && instance?.getMessagingExperienceState()?.windowState !== 'hidden';\n};\n\nconst openChat = (event) => {\n  if (!chatInitialized) redirectToSupport();\n  const open = window.AdobeMessagingExperienceClient?.openMessagingWindow;\n  if (typeof open !== 'function' || isChatOpen()) return;\n  if (event) {\n    const sourceType = event.target.tagName?.toLowerCase();\n    const sourceText = (sourceType === 'img') ? event.target.alt?.trim() : event.target.innerText?.trim();\n    open({\n      sourceType,\n      sourceText,\n    });\n  } else {\n    open({});\n  }\n};\n\nconst startInitialization = async (config, event, onDemand) => {\n  const asset = 'https://client.messaging.adobe.com/latest/AdobeMessagingClient';\n  await Promise.all([\n    loadStyle(`${asset}.css`),\n    loadScript(`${asset}.js`),\n  ]);\n  let language;\n  let region;\n  if (config.locale.ietf.includes('-')) {\n    [language, region] = config.locale.ietf.split('-');\n  } else {\n    [region, language] = config.locale.prefix.replace('/', '').split('_');\n    if (region === 'africa') region = 'ZA';\n  }\n\n  window.AdobeMessagingExperienceClient.initialize({\n    appid: getMetadata('jarvis-surface-id') || config.jarvis.id,\n    appver: getMetadata('jarvis-surface-version') || config.jarvis.version,\n    env: config.env.name !== 'prod' ? 'stage' : 'prod',\n    clientId: window.adobeid?.client_id,\n    accessToken: window.adobeIMS?.isSignedInUser()\n      ? `Bearer ${window.adobeIMS.getAccessToken()?.token}` : undefined,\n    lazyLoad: true,\n    loadedVia: 'milo',\n    language: language || 'en',\n    region,\n    cookiesEnabled: window.adobePrivacy?.activeCookieGroups()?.length > 1,\n    cookies: {\n      mcid: window.alloy ? await window.alloy('getIdentity')\n        .then((data) => data?.identity?.ECID).catch(() => undefined) : undefined,\n    },\n    callbacks: {\n      initCallback: (data) => {\n        chatInitialized = !!data?.releaseControl?.showAdobeMessaging;\n      },\n      onReadyCallback: () => {\n        if (onDemand) {\n          openChat(event);\n        }\n      },\n      initErrorCallback: () => {},\n      chatStateCallback: () => {},\n      getContextCallback: () => {},\n      signInProvider: window.adobeIMS?.signIn,\n      analyticsCallback: (eventData) => {\n        if (!window.alloy_all || !window.digitalData) return;\n        const data = eventData?.events?.[0]?.data;\n        if (!data || isSilentEvent(data)) return;\n        if (data['event.subcategory']?.toLowerCase() === 'launch'\n          && data['event.workflow']?.toLowerCase() === 'init') {\n          if (data['event.type']?.toLowerCase() === 'render') {\n            sendChatIconRenderEvent(data);\n            return;\n          }\n          if (data['event.type']?.toLowerCase() === 'click') {\n            sendChatIconClickEvent(data);\n            return;\n          }\n        }\n        if (data['content.name']?.toLowerCase() === 'auth-subproduct') {\n          sendProductEvent(data);\n          return;\n        }\n        if (data['content.name']?.toLowerCase() === '5-star-survey') {\n          sendSurveyFeedbackEvent(data);\n          return;\n        }\n        if (data['event.error_code'] && data['event.error_type']) {\n          sendChatErrorEvent(data);\n          return;\n        }\n        sendPrimaryEvent(data);\n      },\n    },\n  });\n};\n\nconst initJarvisChat = async (\n  config,\n  loadScriptFunction,\n  loadStyleFunction,\n  getMetadataFunction,\n) => {\n  if (!config?.jarvis) return;\n\n  loadScript = loadScriptFunction;\n  loadStyle = loadStyleFunction;\n  getMetadata = getMetadataFunction;\n\n  const onDemandMeta = getMetadata('jarvis-on-demand')?.toLowerCase();\n  const onDemand = onDemandMeta ? onDemandMeta === 'on' : config.jarvis.onDemand;\n\n  document.addEventListener('click', async (event) => {\n    if (!event.target.closest('[href*=\"#open-jarvis-chat\"]')) return;\n    event.preventDefault();\n    if (onDemand && !chatInitialized) {\n      await startInitialization(config, event, onDemand);\n    } else {\n      openChat(event);\n    }\n  });\n  if (!onDemand) {\n    await startInitialization(config);\n  }\n};\n\nexport {\n  initJarvisChat,\n  openChat,\n};\n"],"names":["chatInitialized","loadScript","loadStyle","getMetadata","isSilentEvent","data","getBaseEvent","chatConversationId","chatConversationSessionId","chatWorkflow","chatCategory","chatSubcategory","chatType","chatSubtype","chatUserguid","chatLanguage","chatPagename","chatVisitorguid","chatUrl","chatOrgguid","chatReferrer","chatClientId","chatSourceName","chatPlatform","chatContentName","chatEnv","setSophiaLayer","sophiaData","variationId","actionBlockId","campaignId","containerId","controlGroupId","treatmentId","surfaceId","Object","keys","forEach","key","length","sophiaDataCaptured","id","captured","sophiaDataLayer","window","digitalData","sophiaResponse","fromPage","Array","isArray","some","sophiaEvent","push","sendEvent","_satellite","track","xdm","web","webInteraction","name","primaryEvent","eventInfo","eventName","_adobe_corpnew","chat","getDataProperties","properties","reduce","str","prop","output","sendChatIconRenderEvent","eventAction","chatInfo","chatConversationUnread","sendChatIconClickEvent","sendProductEvent","primaryProduct","productName","sendSurveyFeedbackEvent","sendChatErrorEvent","chatErrorCode","chatErrorType","chatErrorDescription","sendPrimaryEvent","redirectToSupport","location","assign","isChatOpen","instance","AdobeMessagingExperienceClient","isAdobeMessagingClientInitialized","getMessagingExperienceState","windowState","openChat","event","open","openMessagingWindow","sourceType","target","tagName","toLowerCase","sourceText","alt","trim","innerText","startInitialization","config","onDemand","asset","Promise","resolve","all","then","_temp7","_window$alloy$then$ca","_initialize","call","_window$AdobeMessagin","appid","_temp","appver","_temp2","env","_temp3","clientId","_window$adobeid$clien","accessToken","_temp4","lazyLoad","loadedVia","language","_temp5","region","_region","cookiesEnabled","_temp6","cookies","mcid","callbacks","initCallback","releaseControl","showAdobeMessaging","onReadyCallback","initErrorCallback","chatStateCallback","getContextCallback","signInProvider","adobeIMS","signIn","analyticsCallback","eventData","alloy_all","events","locale","ietf","includes","split","prefix","replace","initialize","adobePrivacy","activeCookieGroups","isSignedInUser","getAccessToken","token","undefined","adobeid","client_id","jarvis","version","_window$alloy","alloy","identity","ECID","catch","e","reject","initJarvisChat","loadScriptFunction","loadStyleFunction","getMetadataFunction","onDemandMeta","document","addEventListener","closest","preventDefault","_temp9","_temp8"],"mappings":"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"}