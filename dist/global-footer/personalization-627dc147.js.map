{"version":3,"file":"personalization-627dc147.js","sources":["../../libs/features/personalization/personalization.js"],"sourcesContent":["/* eslint-disable no-console */\n\nimport {\n  createTag, getConfig, loadLink, loadScript, localizeLink, updateConfig,\n} from '../../utils/utils.js';\nimport { getEntitlementMap } from './entitlements.js';\n\n/* c8 ignore start */\nconst PHONE_SIZE = window.screen.width < 768 || window.screen.height < 768;\nexport const PERSONALIZATION_TAGS = {\n  all: () => true,\n  chrome: () => navigator.userAgent.includes('Chrome') && !navigator.userAgent.includes('Edg'),\n  firefox: () => navigator.userAgent.includes('Firefox'),\n  safari: () => navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome'),\n  edge: () => navigator.userAgent.includes('Edg'),\n  android: () => navigator.userAgent.includes('Android'),\n  ios: () => /iPad|iPhone|iPod/.test(navigator.userAgent),\n  windows: () => navigator.userAgent.includes('Windows'),\n  mac: () => navigator.userAgent.includes('Macintosh'),\n  'mobile-device': () => /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Touch/i.test(navigator.userAgent),\n  phone: () => PERSONALIZATION_TAGS['mobile-device']() && PHONE_SIZE,\n  tablet: () => PERSONALIZATION_TAGS['mobile-device']() && !PHONE_SIZE,\n  desktop: () => !PERSONALIZATION_TAGS['mobile-device'](),\n  loggedout: () => !window.adobeIMS?.isSignedInUser(),\n  loggedin: () => !!window.adobeIMS?.isSignedInUser(),\n};\nconst PERSONALIZATION_KEYS = Object.keys(PERSONALIZATION_TAGS);\n/* c8 ignore stop */\n\nconst CLASS_EL_DELETE = 'p13n-deleted';\nconst CLASS_EL_REPLACE = 'p13n-replaced';\nconst COLUMN_NOT_OPERATOR = 'not';\nconst TARGET_EXP_PREFIX = 'target-';\nconst INLINE_HASH = '_inline';\nconst PAGE_URL = new URL(window.location.href);\n\nexport const TRACKED_MANIFEST_TYPE = 'personalization';\n\n// Replace any non-alpha chars except comma, space, ampersand and hyphen\nconst RE_KEY_REPLACE = /[^a-z0-9\\- _,&=]/g;\n\nconst MANIFEST_KEYS = [\n  'action',\n  'selector',\n  'pagefilter',\n  'page filter',\n  'page filter optional',\n];\n\nconst DATA_TYPE = {\n  JSON: 'json',\n  TEXT: 'text',\n};\n\nconst IN_BLOCK_SELECTOR_PREFIX = 'in-block:';\n\nexport const appendJsonExt = (path) => (path.endsWith('.json') ? path : `${path}.json`);\n\nexport const normalizePath = (p, localize = true) => {\n  let path = p;\n\n  if (!path?.includes('/')) {\n    return path;\n  }\n\n  const config = getConfig();\n\n  if (path.startsWith(config.codeRoot)\n    || path.includes('.hlx.')\n    || path.includes('.adobe.')) {\n    try {\n      const url = new URL(path);\n      const firstFolder = url.pathname.split('/')[1];\n      if (!localize\n        || config.locale.ietf === 'en-US'\n        || url.hash.includes('#_dnt')\n        || firstFolder in config.locales\n        || path.includes('.json')) {\n        path = url.pathname;\n      } else {\n        path = `${config.locale.prefix}${url.pathname}`;\n      }\n    } catch (e) { /* return path below */ }\n  } else if (!path.startsWith('http') && !path.startsWith('/')) {\n    path = `/${path}`;\n  }\n  return path;\n};\n\nexport const preloadManifests = ({ targetManifests = [], persManifests = [] }) => {\n  let manifests = targetManifests;\n\n  manifests = manifests.concat(\n    persManifests.map((manifest) => ({\n      ...manifest,\n      manifestPath: normalizePath(appendJsonExt(manifest.manifestPath)),\n      manifestUrl: manifest.manifestPath,\n    })),\n  );\n\n  for (const manifest of manifests) {\n    if (!manifest.manifestData && manifest.manifestPath && !manifest.disabled) {\n      loadLink(\n        manifest.manifestPath,\n        { as: 'fetch', crossorigin: 'anonymous', rel: 'preload' },\n      );\n    }\n  }\n  return manifests;\n};\n\nexport const getFileName = (path) => path?.split('/').pop();\n\nconst createFrag = (el, url, manifestId) => {\n  let href = url;\n  try {\n    const { pathname, search, hash } = new URL(url);\n    href = `${pathname}${search}${hash}`;\n  } catch {\n    // ignore\n  }\n  const a = createTag('a', { href }, url);\n  if (manifestId) a.dataset.manifestId = manifestId;\n  let frag = createTag('p', undefined, a);\n  const isSection = el.parentElement.nodeName === 'MAIN';\n  if (isSection) {\n    frag = createTag('div', undefined, frag);\n  }\n  loadLink(`${localizeLink(a.href)}.plain.html`, { as: 'fetch', crossorigin: 'anonymous', rel: 'preload' });\n  return frag;\n};\n\nconst GLOBAL_CMDS = [\n  'insertscript',\n  'replacepage',\n  'updatemetadata',\n  'useblockcode',\n];\n\nconst CREATE_CMDS = {\n  insertafter: 'afterend',\n  insertbefore: 'beforebegin',\n  prependtosection: 'afterbegin',\n  appendtosection: 'beforeend',\n};\n\nconst COMMANDS = {\n  remove: (el, target, manifestId) => {\n    if (target === 'false') return;\n    if (manifestId) {\n      el.dataset.removedManifestId = manifestId;\n      return;\n    }\n    el.classList.add(CLASS_EL_DELETE);\n  },\n  replace: (el, target, manifestId) => {\n    if (!el || el.classList.contains(CLASS_EL_REPLACE)) return;\n    el.insertAdjacentElement('beforebegin', createFrag(el, target, manifestId));\n    el.classList.add(CLASS_EL_DELETE, CLASS_EL_REPLACE);\n  },\n};\n\nfunction checkSelectorType(selector) {\n  return selector?.startsWith('/') || selector?.startsWith('http') ? 'fragment' : 'css';\n}\n\nconst fetchData = async (url, type = DATA_TYPE.JSON) => {\n  try {\n    const resp = await fetch(url);\n    if (!resp.ok) {\n      /* c8 ignore next 5 */\n      if (resp.status === 404) {\n        throw new Error('File not found');\n      }\n      throw new Error(`Invalid response: ${resp.status} ${resp.statusText}`);\n    }\n    return await resp[type]();\n  } catch (e) {\n    /* c8 ignore next 3 */\n    console.log(`Error loading content: ${url}`, e.message || e);\n  }\n  return null;\n};\n\nconst getBlockProps = (fVal) => {\n  let val = fVal;\n  if (val?.includes('\\\\')) val = val?.split('\\\\').join('/');\n  if (!val?.startsWith('/')) val = `/${val}`;\n  const blockSelector = val?.split('/').pop();\n  const { origin } = PAGE_URL;\n  if (origin.includes('.hlx.') || origin.includes('localhost')) {\n    if (val.startsWith('/libs/')) {\n      /* c8 ignore next 2 */\n      const { miloLibs, codeRoot } = getConfig();\n      val = `${miloLibs || codeRoot}${val.replace('/libs', '')}`;\n    } else {\n      val = `${origin}${val}`;\n    }\n  }\n  return { blockSelector, blockTarget: val };\n};\n\nconst consolidateArray = (arr, prop, existing = []) => arr\n  .reduce((results, i) => [...results, ...i[prop] || []], existing);\n\nconst consolidateObjects = (arr, prop, existing = {}) => arr.reduce((propMap, item) => {\n  item[prop]?.forEach((i) => {\n    const { selector, val } = i;\n    if (prop === 'blocks') {\n      propMap[selector] = val;\n      return;\n    }\n\n    if (selector in propMap) return;\n    const action = {\n      action: i.action,\n      fragment: val,\n      selector,\n      manifestPath: item.manifestPath,\n      manifestId: i.manifestId,\n    };\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in propMap) {\n      if (propMap[key].fragment === selector) propMap[key] = action;\n    }\n    propMap[selector] = action;\n  });\n  return { ...existing, ...propMap };\n}, {});\n\nexport const matchGlob = (searchStr, inputStr) => {\n  const pattern = searchStr.replace(/\\*\\*/g, '.*');\n  const reg = new RegExp(`^${pattern}(\\\\.html)?$`, 'i'); // devtool bug needs this backtick: `\n  return reg.test(inputStr);\n};\n\nexport async function replaceInner(path, element) {\n  if (!path || !element) return false;\n  let plainPath = path.endsWith('/') ? `${path}index` : path;\n  plainPath = plainPath.endsWith('.plain.html') ? plainPath : `${plainPath}.plain.html`;\n  const html = await fetchData(plainPath, DATA_TYPE.TEXT);\n  if (!html) return false;\n\n  element.innerHTML = html;\n  const { decorateArea } = getConfig();\n  if (decorateArea) decorateArea(element);\n  return true;\n}\n/* c8 ignore stop */\n\nconst setMetadata = (metadata) => {\n  const { selector, val } = metadata;\n  if (!selector || !val) return;\n  const propName = selector.startsWith('og:') ? 'property' : 'name';\n  let metaEl = document.querySelector(`meta[${propName}=\"${selector}\"]`);\n  if (!metaEl) {\n    metaEl = document.createElement('meta');\n    metaEl.setAttribute(propName, selector);\n    document.head.append(metaEl);\n  }\n  metaEl.setAttribute('content', val);\n};\n\nfunction toLowerAlpha(str) {\n  const s = str.toLowerCase();\n  return s.replace(RE_KEY_REPLACE, '');\n}\n\nfunction normalizeKeys(obj) {\n  return Object.keys(obj).reduce((newObj, key) => {\n    newObj[toLowerAlpha(key)] = obj[key];\n    return newObj;\n  }, {});\n}\n\nconst getDivInTargetedCell = (tableCell) => {\n  tableCell.replaceChildren();\n  const div = document.createElement('div');\n  tableCell.appendChild(div);\n  return div;\n};\n\nconst querySelector = (el, selector, all = false) => {\n  try {\n    return all ? el.querySelectorAll(selector) : el.querySelector(selector);\n  } catch (e) {\n    /* eslint-disable-next-line no-console */\n    console.log('Invalid selector: ', selector);\n    return null;\n  }\n};\n\nfunction getTrailingNumber(s) {\n  const match = s.match(/\\d+$/);\n  return match ? parseInt(match[0], 10) : null;\n}\n\nfunction getSection(rootEl, idx) {\n  return rootEl === document\n    ? document.querySelector(`body > main > div:nth-child(${idx})`)\n    : rootEl.querySelector(`:scope > div:nth-child(${idx})`);\n}\n\nfunction registerInBlockActions(cmd, manifestId) {\n  const { action, target, selector } = cmd;\n  const command = { action, target, manifestId };\n\n  const blockAndSelector = selector.substring(IN_BLOCK_SELECTOR_PREFIX.length).trim().split(/\\s+/);\n  const [blockName] = blockAndSelector;\n\n  const config = getConfig();\n  config.mep.inBlock ??= {};\n  config.mep.inBlock[blockName] ??= {};\n\n  let blockSelector;\n  if (blockAndSelector.length > 1) {\n    blockSelector = blockAndSelector.slice(1).join(' ');\n    command.selector = blockSelector;\n    if (checkSelectorType(blockSelector) === 'fragment') {\n      config.mep.inBlock[blockName].fragments ??= {};\n      const { fragments } = config.mep.inBlock[blockName];\n      delete command.selector;\n      if (blockSelector in fragments) return;\n\n      // eslint-disable-next-line no-restricted-syntax\n      for (const key in fragments) {\n        if (fragments[key].target === blockSelector) fragments[key] = command;\n      }\n      fragments[blockSelector] = command;\n\n      blockSelector = normalizePath(blockSelector);\n      // eslint-disable-next-line no-restricted-syntax\n      for (const key in fragments) {\n        if (fragments[key].target === blockSelector) fragments[key] = command;\n      }\n      fragments[blockSelector] = command;\n      return;\n    }\n  }\n  config.mep.inBlock[blockName].commands ??= [];\n  config.mep.inBlock[blockName].commands.push(command);\n}\n\nfunction getSelectedElement(selector, action, rootEl) {\n  if (!selector) return null;\n  if ((action.includes('appendtosection') || action.includes('prependtosection'))) {\n    if (!selector.includes('section')) return null;\n    const section = selector.trim().replace('section', '');\n    if (section !== '' && Number.isNaN(section)) return null;\n  }\n  if (checkSelectorType(selector) === 'fragment') {\n    try {\n      const fragment = document.querySelector(`a[href*=\"${normalizePath(selector, false)}\"], a[href*=\"${normalizePath(selector, true)}\"]`);\n      if (fragment) return fragment.parentNode;\n      return null;\n    } catch (e) {\n      return null;\n    }\n  }\n\n  let selectedEl;\n  if (selector.includes('.') || !['section', 'block', 'row'].some((s) => selector.includes(s))) {\n    selectedEl = querySelector(rootEl, selector);\n    if (selectedEl) return selectedEl;\n  }\n\n  const terms = selector.split(/\\s+/);\n\n  let section = null;\n  if (terms[0]?.startsWith('section')) {\n    const sectionIdx = getTrailingNumber(terms[0]) || 1;\n    section = getSection(rootEl, sectionIdx);\n    terms.shift();\n  }\n\n  if (terms.length) {\n    const blockStr = terms.shift();\n    if (blockStr.includes('.')) {\n      selectedEl = querySelector(section || rootEl, blockStr);\n    } else {\n      const blockIndex = getTrailingNumber(blockStr) || 1;\n      const blockName = blockStr.replace(`${blockIndex}`, '');\n      if (blockName === 'block') {\n        if (!section) section = getSection(rootEl, 1);\n        selectedEl = querySelector(section, `:scope > div:nth-of-type(${blockIndex})`);\n      } else {\n        selectedEl = querySelector(section || rootEl, `.${blockName}`, true)?.[blockIndex - 1];\n      }\n    }\n  } else if (section) {\n    return section;\n  }\n\n  if (terms.length) {\n    // find targeted table cell in rowX colY format\n    const rowColMatch = /row(?<row>\\d+)\\s+col(?<col>\\d+)/gm.exec(terms.join(' '));\n    if (rowColMatch) {\n      const { row, col } = rowColMatch.groups;\n      const tableCell = querySelector(selectedEl, `:nth-child(${row}) > :nth-child(${col})`);\n      if (!tableCell) return null;\n      return getDivInTargetedCell(tableCell);\n    }\n  }\n\n  return selectedEl;\n}\n\nconst addHash = (url, newHash) => {\n  if (!newHash) return url;\n  try {\n    const { origin, pathname, search } = new URL(url);\n    return `${origin}${pathname}${search}#${newHash}`;\n  } catch (e) {\n    return `${url}#${newHash}`;\n  }\n};\n\nexport function handleCommands(commands, rootEl = document, forceInline = false) {\n  commands.forEach((cmd) => {\n    const { manifestId } = cmd;\n    const { action, selector, target: trgt } = cmd;\n    const target = forceInline ? addHash(trgt, INLINE_HASH) : trgt;\n    if (selector.startsWith(IN_BLOCK_SELECTOR_PREFIX)) {\n      registerInBlockActions(cmd, manifestId);\n      return;\n    }\n\n    if (action in COMMANDS) {\n      const el = getSelectedElement(selector, action, rootEl);\n      COMMANDS[action](el, target, manifestId);\n    } else if (action in CREATE_CMDS) {\n      const el = getSelectedElement(selector, action, rootEl);\n      el?.insertAdjacentElement(\n        CREATE_CMDS[action],\n        createFrag(el, target, manifestId),\n      );\n    } else {\n      /* c8 ignore next 2 */\n      console.log('Invalid command found: ', cmd);\n    }\n  });\n}\n\nconst getVariantInfo = (line, variantNames, variants, manifestId) => {\n  const action = line.action?.toLowerCase().replace('content', '').replace('fragment', '');\n  const { selector } = line;\n  const pageFilter = line['page filter'] || line['page filter optional'];\n\n  if (pageFilter && !matchGlob(pageFilter, new URL(window.location).pathname)) return;\n\n  variantNames.forEach((vn) => {\n    if (!line[vn] || line[vn].toLowerCase() === 'false') return;\n\n    const variantInfo = {\n      action,\n      selector,\n      pageFilter,\n      target: line[vn],\n      selectorType: checkSelectorType(selector),\n      manifestId,\n    };\n\n    if (action in COMMANDS && variantInfo.selectorType === 'fragment') {\n      variants[vn].fragments.push({\n        selector: normalizePath(variantInfo.selector),\n        val: normalizePath(line[vn]),\n        action,\n        manifestId,\n      });\n    } else if (GLOBAL_CMDS.includes(action)) {\n      variants[vn][action] = variants[vn][action] || [];\n\n      if (action === 'useblockcode') {\n        const { blockSelector, blockTarget } = getBlockProps(line[vn]);\n        variants[vn][action].push({\n          selector: blockSelector,\n          val: blockTarget,\n          pageFilter,\n          manifestId,\n        });\n      } else {\n        variants[vn][action].push({\n          selector: normalizePath(selector),\n          val: normalizePath(line[vn]),\n          pageFilter,\n          manifestId,\n        });\n      }\n    } else if (action in COMMANDS || action in CREATE_CMDS) {\n      variants[vn].commands.push(variantInfo);\n    } else {\n      /* c8 ignore next 2 */\n      console.log('Invalid action found: ', line);\n    }\n  });\n};\n\nexport function parseConfig(data, manifestId) {\n  if (!data?.length) return null;\n\n  const config = {};\n  const experiences = data.map((d) => normalizeKeys(d));\n\n  try {\n    const variants = {};\n    const variantNames = Object.keys(experiences[0])\n      .filter((vn) => !MANIFEST_KEYS.includes(vn));\n\n    variantNames.forEach((vn) => {\n      variants[vn] = { commands: [], fragments: [] };\n    });\n\n    experiences.forEach((line) => getVariantInfo(line, variantNames, variants, manifestId));\n\n    config.variants = variants;\n    config.variantNames = variantNames;\n    return config;\n  } catch (e) {\n    /* c8 ignore next 3 */\n    console.log('error parsing personalization config:', e, experiences);\n  }\n  return null;\n}\n\n/* c8 ignore start */\nfunction parsePlaceholders(placeholders, config, selectedVariantName = '') {\n  if (!placeholders?.length || selectedVariantName === 'default') return config;\n  const valueNames = [\n    'value',\n    selectedVariantName.toLowerCase(),\n    config.locale.ietf.toLowerCase(),\n    ...config.locale.ietf.toLowerCase().split('-'),\n  ];\n  const [val] = Object.entries(placeholders[0])\n    .find(([key]) => valueNames.includes(key.toLowerCase()));\n  if (val) {\n    const results = placeholders.reduce((res, item) => {\n      res[item.key] = item[val];\n      return res;\n    }, {});\n    config.placeholders = { ...(config.placeholders || {}), ...results };\n  }\n  return config;\n}\n\nconst checkForParamMatch = (paramStr) => {\n  const [name, val] = paramStr.split('param-')[1].split('=');\n  if (!name) return false;\n  const params = new URLSearchParams(\n    Array.from(PAGE_URL.searchParams, ([key, value]) => [key.toLowerCase(), value?.toLowerCase()]),\n  );\n  const searchParamVal = params.get(name.toLowerCase());\n  if (searchParamVal !== null) {\n    if (val) return val === searchParamVal;\n    return true; // if no val is set, just check for existence of param\n  }\n  return false;\n};\n\nasync function getPersonalizationVariant(manifestPath, variantNames = [], variantLabel = null) {\n  const variantInfo = variantNames.reduce((acc, name) => {\n    let nameArr = [name];\n    if (!name.startsWith(TARGET_EXP_PREFIX)) nameArr = name.split(',');\n    const vNames = nameArr.map((v) => v.trim()).filter(Boolean);\n    acc[name] = vNames;\n    acc.allNames = [...acc.allNames, ...vNames];\n    return acc;\n  }, { allNames: [] });\n\n  const entitlementKeys = Object.values(await getEntitlementMap());\n  const hasEntitlementTag = entitlementKeys.some((tag) => variantInfo.allNames.includes(tag));\n\n  let userEntitlements = [];\n  if (hasEntitlementTag) {\n    const config = getConfig();\n    userEntitlements = await config.entitlements();\n  }\n\n  const hasMatch = (name) => {\n    if (name === '') return true;\n    if (name === variantLabel?.toLowerCase()) return true;\n    if (name.startsWith('param-')) return checkForParamMatch(name);\n    if (userEntitlements?.includes(name)) return true;\n    return PERSONALIZATION_KEYS.includes(name) && PERSONALIZATION_TAGS[name]();\n  };\n\n  const matchVariant = (name) => {\n    if (name.startsWith(TARGET_EXP_PREFIX)) return hasMatch(name);\n    const processedList = name.split('&').map((condition) => {\n      const reverse = condition.trim().startsWith(COLUMN_NOT_OPERATOR);\n      const match = hasMatch(condition.replace(COLUMN_NOT_OPERATOR, '').trim());\n      return reverse ? !match : match;\n    });\n    return !processedList.includes(false);\n  };\n\n  const matchingVariant = variantNames.find((variant) => variantInfo[variant].some(matchVariant));\n  return matchingVariant;\n}\n\nconst createDefaultExperiment = (manifest) => ({\n  disabled: manifest.disabled,\n  event: manifest.event,\n  manifest: manifest.manifestPath,\n  selectedVariant: { commands: [], fragments: [] },\n  selectedVariantName: 'default',\n  variantNames: ['all'],\n  variants: {},\n});\n\nexport async function getPersConfig(info, override = false) {\n  const {\n    name,\n    manifestData,\n    manifestPath,\n    manifestUrl,\n    manifestPlaceholders,\n    manifestInfo,\n    variantLabel,\n    disabled,\n    event,\n  } = info;\n  if (disabled && !override) {\n    return createDefaultExperiment(info);\n  }\n  let data = manifestData;\n  if (!data) {\n    const fetchedData = await fetchData(manifestPath, DATA_TYPE.JSON);\n    if (fetchData) data = fetchedData;\n  }\n\n  const persData = data?.experiences?.data || data?.data || data;\n  if (!persData) return null;\n\n  let manifestId = getFileName(manifestPath);\n  const globalConfig = getConfig();\n  if (!globalConfig.mep?.preview) {\n    manifestId = false;\n  } else if (name) {\n    manifestId = `${name}: ${manifestId}`;\n  }\n  const config = parseConfig(persData, manifestId);\n\n  if (!config) {\n    /* c8 ignore next 3 */\n    console.log('Error loading personalization config: ', name || manifestPath);\n    return null;\n  }\n\n  const infoTab = manifestInfo || data?.info?.data;\n  const infoKeyMap = {\n    'manifest-type': ['Personalization', 'Promo', 'Test'],\n    'manifest-execution-order': ['First', 'Normal', 'Last'],\n  };\n  if (infoTab) {\n    const infoObj = infoTab?.reduce((acc, item) => {\n      acc[item.key] = item.value;\n      return acc;\n    }, {});\n    config.manifestOverrideName = infoObj?.['manifest-override-name']?.toLowerCase();\n    config.manifestType = infoObj?.['manifest-type']?.toLowerCase();\n    const executionOrder = {\n      'manifest-type': 1,\n      'manifest-execution-order': 1,\n    };\n    Object.keys(infoObj).forEach((key) => {\n      if (!infoKeyMap[key]) return;\n      const index = infoKeyMap[key].indexOf(infoObj[key]);\n      executionOrder[key] = index > -1 ? index : 1;\n    });\n    config.executionOrder = `${executionOrder['manifest-execution-order']}-${executionOrder['manifest-type']}`;\n  } else {\n    // eslint-disable-next-line prefer-destructuring\n    config.manifestType = infoKeyMap['manifest-type'][1];\n    config.executionOrder = '1-1';\n  }\n\n  config.manifestPath = normalizePath(manifestPath);\n  const selectedVariantName = await getPersonalizationVariant(\n    config.manifestPath,\n    config.variantNames,\n    variantLabel,\n  );\n\n  if (selectedVariantName && config.variantNames.includes(selectedVariantName)) {\n    config.run = true;\n    config.selectedVariantName = selectedVariantName;\n    config.selectedVariant = config.variants[selectedVariantName];\n  } else {\n    /* c8 ignore next 2 */\n    config.selectedVariantName = 'default';\n    config.selectedVariant = 'default';\n  }\n\n  const placeholders = manifestPlaceholders || data?.placeholders?.data;\n  if (placeholders) {\n    updateConfig(\n      parsePlaceholders(placeholders, getConfig(), config.selectedVariantName),\n    );\n  }\n\n  config.name = name;\n  config.manifest = manifestPath;\n  config.manifestUrl = manifestUrl;\n  config.disabled = disabled;\n  config.event = event;\n  return config;\n}\n\nexport const deleteMarkedEls = (rootEl = document) => {\n  [...rootEl.querySelectorAll(`.${CLASS_EL_DELETE}`)]\n    .forEach((el) => el.remove());\n};\n\nconst normalizeFragPaths = ({ selector, val, action }) => ({\n  selector: normalizePath(selector),\n  val: normalizePath(val),\n  action,\n});\n\nexport async function categorizeActions(experiment) {\n  if (!experiment) return null;\n  const { manifestPath, selectedVariant } = experiment;\n  if (!selectedVariant || selectedVariant === 'default') return { experiment };\n\n  if (selectedVariant.replacepage) {\n    // only one replacepage can be defined\n    await replaceInner(selectedVariant.replacepage[0]?.val, document.querySelector('main'));\n    document.querySelector('main').dataset.manifestId = manifestPath;\n  }\n\n  selectedVariant.insertscript?.map((script) => loadScript(script.val));\n  selectedVariant.updatemetadata?.map((metadata) => setMetadata(metadata));\n\n  selectedVariant.fragments &&= selectedVariant.fragments.map(normalizeFragPaths);\n\n  return {\n    manifestPath,\n    experiment,\n    blocks: selectedVariant.useblockcode,\n    fragments: selectedVariant.fragments,\n    commands: selectedVariant.commands,\n  };\n}\n\nfunction overridePersonalizationVariant(manifest, config) {\n  const { manifestPath, variantNames } = manifest;\n  if (!config.mep?.override) return;\n  let selectedVariant;\n  config.mep?.override?.split('---').some((item) => {\n    const pair = item.trim().split('--');\n    if (pair[0] === manifestPath && pair.length > 1) {\n      [, selectedVariant] = pair;\n      return true;\n    }\n    return false;\n  });\n  if (!selectedVariant) return;\n  if (variantNames.includes(selectedVariant)) {\n    manifest.selectedVariantName = selectedVariant;\n    manifest.selectedVariant = manifest.variants[selectedVariant];\n    return;\n  }\n  manifest.selectedVariantName = selectedVariant;\n  manifest.selectedVariant = manifest.variants[selectedVariant];\n}\n\nfunction compareExecutionOrder(a, b) {\n  if (a.executionOrder === b.executionOrder) return 0;\n  return a.executionOrder > b.executionOrder ? 1 : -1;\n}\n\nexport function cleanAndSortManifestList(manifests) {\n  const config = getConfig();\n  const manifestObj = {};\n  let allManifests = manifests;\n  if (config.mep?.experiments) allManifests = [...manifests, ...config.mep.experiments];\n  allManifests.forEach((manifest) => {\n    try {\n      if (!manifest?.manifest) return;\n      if (!manifest.manifestPath) manifest.manifestPath = normalizePath(manifest.manifest);\n      if (manifest.manifestPath in manifestObj) {\n        let fullManifest = manifestObj[manifest.manifestPath];\n        let freshManifest = manifest;\n        if (manifest.name) {\n          fullManifest = manifest;\n          freshManifest = manifestObj[manifest.manifestPath];\n        }\n        freshManifest.name = fullManifest.name;\n        freshManifest.selectedVariantName = fullManifest.selectedVariantName;\n        freshManifest.selectedVariant = freshManifest.variants[freshManifest.selectedVariantName];\n        manifestObj[manifest.manifestPath] = freshManifest;\n      } else {\n        manifestObj[manifest.manifestPath] = manifest;\n      }\n      if (config.mep?.override) overridePersonalizationVariant(manifest, config);\n    } catch (e) {\n      console.warn(e);\n      window.lana?.log(`MEP Error parsing manifests: ${e.toString()}`);\n    }\n  });\n  return Object.values(manifestObj).sort(compareExecutionOrder);\n}\n\nexport function handleFragmentCommand(command, a) {\n  const { action, fragment, manifestId } = command;\n  if (action === 'replace') {\n    a.href = fragment;\n    if (manifestId) a.dataset.manifestId = manifestId;\n    return fragment;\n  }\n  if (action === 'remove') {\n    if (manifestId) {\n      a.parentElement.dataset.removedManifestId = manifestId;\n    } else {\n      a.parentElement.remove();\n    }\n  }\n  return false;\n}\n\nexport async function applyPers(manifests, postLCP = false) {\n  try {\n    const config = getConfig();\n    if (!postLCP) {\n      const {\n        mep: mepParam,\n        mepHighlight,\n        mepButton,\n      } = Object.fromEntries(PAGE_URL.searchParams);\n      config.mep = {\n        handleFragmentCommand,\n        preview: (mepButton !== 'off' && (config.env?.name !== 'prod' || mepButton)),\n        override: mepParam ? decodeURIComponent(mepParam) : '',\n        highlight: (mepHighlight !== undefined && mepHighlight !== 'false'),\n        mepParam,\n        targetEnabled: config.mep?.targetEnabled,\n      };\n    }\n\n    if (!manifests?.length) return;\n    let experiments = manifests;\n    for (let i = 0; i < experiments.length; i += 1) {\n      experiments[i] = await getPersConfig(experiments[i], config.mep?.override);\n    }\n\n    experiments = cleanAndSortManifestList(experiments);\n\n    let results = [];\n\n    for (const experiment of experiments) {\n      const result = await categorizeActions(experiment);\n      if (result) {\n        results.push(result);\n      }\n    }\n    results = results.filter(Boolean);\n\n    config.mep.experiments ??= [];\n    config.mep.experiments = experiments;\n    config.mep.blocks = consolidateObjects(results, 'blocks', config.mep.blocks);\n    config.mep.fragments = consolidateObjects(results, 'fragments', config.mep.fragments);\n    config.mep.commands = consolidateArray(results, 'commands', config.mep.commands);\n\n    if (!postLCP) handleCommands(config.mep.commands);\n    deleteMarkedEls();\n\n    const pznList = results.filter((r) => (r.experiment?.manifestType === TRACKED_MANIFEST_TYPE));\n    if (!pznList.length) return;\n\n    const pznVariants = pznList.map((r) => {\n      const val = r.experiment.selectedVariantName.replace(TARGET_EXP_PREFIX, '').trim().slice(0, 15);\n      return val === 'default' ? 'nopzn' : val;\n    });\n    const pznManifests = pznList.map((r) => {\n      const val = r.experiment?.manifestOverrideName || r.experiment?.manifest;\n      return getFileName(val).replace('.json', '').trim().slice(0, 15);\n    });\n    config.mep.martech = `|${pznVariants.join('--')}|${pznManifests.join('--')}`;\n  } catch (e) {\n    console.warn(e);\n    window.lana?.log(`MEP Error: ${e.toString()}`);\n  }\n}\n"],"names":["_catch","body","recover","result","e","then","_settle","pact","state","value","s","_Pact","v","o","bind","observer","prototype","onFulfilled","onRejected","callback","_this","_isSettledPact","thenable","_for","test","update","stage","shouldContinue","updateValue","reject","_resumeAfterTest","_resumeAfterBody","_resumeAfterUpdate","_iteratorSymbol","Symbol","iterator","_forTo","array","check","i","_cycle","length","_forOf","target","step","next","done","return","_fixup","TypeError","values","push","applyPers","manifests","postLCP","Promise","resolve","_temp9","_temp7","results","filter","Boolean","config","mep","experiments","blocks","consolidateObjects","fragments","commands","consolidateArray","handleCommands","deleteMarkedEls","pznList","r","experiment","manifestType","TRACKED_MANIFEST_TYPE","pznVariants","map","val","selectedVariantName","replace","TARGET_EXP_PREFIX","trim","slice","pznManifests","manifestOverrideName","manifest","getFileName","martech","join","cleanAndSortManifestList","_temp6","categorizeActions","getConfig","mepParam","mepHighlight","mepButton","Object","fromEntries","PAGE_URL","searchParams","handleFragmentCommand","preview","env","name","override","decodeURIComponent","highlight","undefined","targetEnabled","_temp8","getPersConfig","_getPersConfig","console","warn","window","lana","log","toString","_temp5","selectedVariant","insertscript","script","loadScript","updatemetadata","metadata","setMetadata","normalizeFragPaths","manifestPath","useblockcode","_temp4","replacepage","replaceInner","document","querySelector","dataset","manifestId","info","_temp3","persData","data","experiences","globalConfig","parseConfig","infoTab","manifestInfo","infoKeyMap","infoObj","reduce","acc","item","key","toLowerCase","executionOrder","keys","forEach","index","indexOf","normalizePath","getPersonalizationVariant","variantNames","variantLabel","includes","run","variants","placeholders","manifestPlaceholders","updateConfig","parsePlaceholders","manifestUrl","disabled","event","manifestData","createDefaultExperiment","_temp2","fetchData","DATA_TYPE","JSON","fetchedData","variantInfo","nameArr","startsWith","split","vNames","allNames","getEntitlementMap","_getEntitlementMap","_temp11","hasMatch","checkForParamMatch","userEntitlements","PERSONALIZATION_KEYS","PERSONALIZATION_TAGS","matchVariant","processedList","condition","reverse","COLUMN_NOT_OPERATOR","match","matchingVariant","find","variant","some","entitlementKeys","hasEntitlementTag","tag","_temp10","entitlements","_config$entitlements","path","element","plainPath","endsWith","TEXT","html","innerHTML","decorateArea","PHONE_SIZE","screen","width","height","all","chrome","navigator","userAgent","firefox","safari","edge","android","ios","windows","mac","mobile-device","phone","tablet","desktop","loggedout","adobeIMS","isSignedInUser","loggedin","CLASS_EL_DELETE","CLASS_EL_REPLACE","INLINE_HASH","URL","location","href","RE_KEY_REPLACE","MANIFEST_KEYS","IN_BLOCK_SELECTOR_PREFIX","appendJsonExt","p","localize","codeRoot","url","firstFolder","pathname","locale","ietf","hash","locales","prefix","preloadManifests","targetManifests","persManifests","concat","_iterator","_createForOfIteratorHelper","_step","n","loadLink","as","crossorigin","rel","err","f","pop","createFrag","el","search","a","createTag","frag","isSection","parentElement","nodeName","localizeLink","GLOBAL_CMDS","CREATE_CMDS","insertafter","insertbefore","prependtosection","appendtosection","COMMANDS","remove","removedManifestId","classList","add","contains","insertAdjacentElement","checkSelectorType","selector","type","_exit","_temp","fetch","resp","ok","status","Error","statusText","_await$resp$type","message","_result","getBlockProps","fVal","blockSelector","origin","miloLibs","blockTarget","arr","prop","existing","propMap","action","fragment","matchGlob","searchStr","inputStr","pattern","reg","RegExp","propName","metaEl","createElement","setAttribute","head","append","toLowerAlpha","str","normalizeKeys","obj","newObj","getDivInTargetedCell","tableCell","replaceChildren","div","appendChild","querySelectorAll","getTrailingNumber","parseInt","getSection","rootEl","idx","registerInBlockActions","cmd","command","blockAndSelector","substring","blockName","inBlock","getSelectedElement","section","Number","isNaN","parentNode","selectedEl","terms","sectionIdx","shift","blockStr","blockIndex","rowColMatch","exec","row","col","groups","addHash","newHash","forceInline","trgt","getVariantInfo","line","pageFilter","vn","selectorType","d","valueNames","entries","res","paramStr","params","URLSearchParams","Array","from","searchParamVal","get","overridePersonalizationVariant","pair","compareExecutionOrder","b","manifestObj","allManifests","fullManifest","freshManifest","sort"],"mappings":"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"}