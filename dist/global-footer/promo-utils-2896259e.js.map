{"version":3,"file":"promo-utils-2896259e.js","sources":["../../libs/features/personalization/promo-utils.js"],"sourcesContent":["import { getMetadata } from '../../utils/utils.js';\n\nconst GMTStringToLocalDate = (gmtString) => new Date(`${gmtString}+00:00`);\n\nexport const isDisabled = (event, searchParams) => {\n  if (!event) return false;\n  const currentDate = searchParams?.get('instant') ? new Date(searchParams.get('instant')) : new Date();\n  if ((!event.start && event.end) || (!event.end && event.start)) return true;\n  return Boolean(event.start && event.end\n    && (currentDate < event.start || currentDate > event.end));\n};\n\nexport default function getPromoManifests(manifestNames, searchParams) {\n  const attachedManifests = manifestNames\n    ? manifestNames.split(',')?.map((manifest) => manifest?.trim())\n    : [];\n  const schedule = getMetadata('schedule');\n  if (!schedule) {\n    return [];\n  }\n  return schedule.split(',')\n    .map((manifest) => {\n      const [name, start, end, manifestPath] = manifest.trim().split('|').map((s) => s.trim());\n      if (attachedManifests.includes(name)) {\n        const event = {\n          name,\n          start: GMTStringToLocalDate(start),\n          end: GMTStringToLocalDate(end),\n        };\n        const disabled = isDisabled(event, searchParams);\n        return { manifestPath, disabled, event };\n      }\n      return null;\n    })\n    .filter((manifest) => manifest != null);\n}\n"],"names":["GMTStringToLocalDate","gmtString","Date","isDisabled","event","searchParams","currentDate","get","start","end","Boolean","getPromoManifests","manifestNames","attachedManifests","split","map","manifest","trim","schedule","getMetadata","name","manifestPath","s","includes","disabled","filter"],"mappings":";;AAEA,MAAMA,oBAAoB,GAAIC,SAAS,IAAK,IAAIC,IAAI,CAAC,GAAGD,SAAS,QAAQ,CAAC;MAE7DE,UAAU,GAAGA,CAACC,KAAK,EAAEC,YAAY,KAAK;EACjD,IAAI,CAACD,KAAK,EAAE,OAAO,KAAK;EACxB,MAAME,WAAW,GAAGD,YAAY,EAAEE,GAAG,CAAC,SAAS,CAAC,GAAG,IAAIL,IAAI,CAACG,YAAY,CAACE,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,IAAIL,IAAI,EAAE;EACrG,IAAK,CAACE,KAAK,CAACI,KAAK,IAAIJ,KAAK,CAACK,GAAG,IAAM,CAACL,KAAK,CAACK,GAAG,IAAIL,KAAK,CAACI,KAAM,EAAE,OAAO,IAAI;EAC3E,OAAOE,OAAO,CAACN,KAAK,CAACI,KAAK,IAAIJ,KAAK,CAACK,GAAG,KACjCH,WAAW,GAAGF,KAAK,CAACI,KAAK,IAAIF,WAAW,GAAGF,KAAK,CAACK,GAAG,CAAC,CAAC;AAC9D;AAEe,SAASE,iBAAiBA,CAACC,aAAa,EAAEP,YAAY,EAAE;EACrE,MAAMQ,iBAAiB,GAAGD,aAAa,GACnCA,aAAa,CAACE,KAAK,CAAC,GAAG,CAAC,EAAEC,GAAG,CAAEC,QAAQ,IAAKA,QAAQ,EAAEC,IAAI,EAAE,CAAC,GAC7D,EAAE;EACN,MAAMC,QAAQ,GAAGC,WAAW,CAAC,UAAU,CAAC;EACxC,IAAI,CAACD,QAAQ,EAAE;IACb,OAAO,EAAE;;EAEX,OAAOA,QAAQ,CAACJ,KAAK,CAAC,GAAG,CAAC,CACvBC,GAAG,CAAEC,QAAQ,IAAK;IACjB,MAAM,CAACI,IAAI,EAAEZ,KAAK,EAAEC,GAAG,EAAEY,YAAY,CAAC,GAAGL,QAAQ,CAACC,IAAI,EAAE,CAACH,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAAEO,CAAC,IAAKA,CAAC,CAACL,IAAI,EAAE,CAAC;IACxF,IAAIJ,iBAAiB,CAACU,QAAQ,CAACH,IAAI,CAAC,EAAE;MACpC,MAAMhB,KAAK,GAAG;QACZgB,IAAI;QACJZ,KAAK,EAAER,oBAAoB,CAACQ,KAAK,CAAC;QAClCC,GAAG,EAAET,oBAAoB,CAACS,GAAG;OAC9B;MACD,MAAMe,QAAQ,GAAGrB,UAAU,CAACC,KAAK,EAAEC,YAAY,CAAC;MAChD,OAAO;QAAEgB,YAAY;QAAEG,QAAQ;QAAEpB;OAAO;;IAE1C,OAAO,IAAI;GACZ,CAAC,CACDqB,MAAM,CAAET,QAAQ,IAAKA,QAAQ,IAAI,IAAI,CAAC;AAC3C;;;;"}