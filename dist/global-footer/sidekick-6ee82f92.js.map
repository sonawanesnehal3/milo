{"version":3,"file":"sidekick-6ee82f92.js","sources":["../../libs/utils/sidekick-decorate.js","../../libs/utils/sidekick.js"],"sourcesContent":["export default function stylePublish(sk) {\n  const style = new CSSStyleSheet();\n  style.replaceSync(`\n    :host {\n      --bg-color: rgb(129 27 14);\n      --text-color: #fff0f0;\n      color-scheme: light dark;\n    }\n    .publish.plugin {\n      order: 100;\n    }\n    .publish.plugin button {\n      background: var(--bg-color);\n      border-color: #b46157;\n      color: var(--text-color);\n      position: relative;\n    }\n    .publish.plugin button:hover {\n      background-color: var(--hlx-sk-button-hover-bg);\n      border-color: unset;\n      color: var(--hlx-sk-button-hover-color);\n    }\n    .publish.plugin button > span {\n      display: none;\n      background: var(--bg-color);\n      border-radius: 4px;\n      line-height: 1.2rem;\n      padding: 8px 12px;\n      position: absolute;\n      top: 34px;\n      left: 50%;\n      transform: translateX(-50%);\n      width: 150px;\n      white-space: pre-wrap;\n    }\n    .publish.plugin button:hover > span {\n      display: block;\n      color: var(--text-color);\n    }\n    .publish.plugin button > span:before {\n      content: '';\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid var(--bg-color);\n      position: absolute;\n      text-align: center;\n      top: -6px;\n      left: 50%;\n      transform: translateX(-50%);\n    }\n  `);\n  sk.shadowRoot.adoptedStyleSheets = [style];\n  setTimeout(() => {\n    const btn = sk.shadowRoot.querySelector('.publish.plugin button');\n    btn?.insertAdjacentHTML('beforeend', `\n      <span>Are you sure? This will publish to production.</span>\n    `);\n  }, 500);\n}\n","import stylePublish from './sidekick-decorate.js';\n\n// loadScript and loadStyle are passed in to avoid circular dependencies\nexport default function init({ createTag, loadBlock, loadScript, loadStyle }) {\n  // manifest v3\n  const sendToCaasListener = async (e) => {\n    const { host, project, ref: branch, repo, owner } = e.detail.data.config;\n    // eslint-disable-next-line import/no-unresolved\n    const { sendToCaaS } = await import('https://milo.adobe.com/tools/send-to-caas/send-to-caas.js');\n    sendToCaaS({ host, project, branch, repo, owner }, loadScript, loadStyle);\n  };\n\n  const checkSchemaListener = async () => {\n    const schema = document.querySelector('script[type=\"application/ld+json\"]');\n    if (schema === null) return;\n    const resultsUrl = 'https://search.google.com/test/rich-results?url=';\n    window.open(`${resultsUrl}${encodeURIComponent(window.location.href)}`, 'check-schema');\n  };\n\n  const preflightListener = async () => {\n    const preflight = createTag('div', { class: 'preflight' });\n    const content = await loadBlock(preflight);\n\n    const { getModal } = await import('../blocks/modal/modal.js');\n    getModal(null, { id: 'preflight', content, closeEvent: 'closeModal' });\n  };\n\n  // Support for legacy manifest v2 - Delete once everyone is migrated to v3\n  document.addEventListener('send-to-caas', async (e) => {\n    const { host, project, branch, repo, owner } = e.detail;\n    const { sendToCaaS } = await import('../../tools/send-to-caas/send-to-caas.js');\n    sendToCaaS({ host, project, branch, repo, owner }, loadScript, loadStyle);\n  });\n\n  const sk = document.querySelector('helix-sidekick');\n\n  // Add plugin listeners here\n  sk.addEventListener('custom:send-to-caas', sendToCaasListener);\n  sk.addEventListener('custom:check-schema', checkSchemaListener);\n  sk.addEventListener('custom:preflight', preflightListener);\n\n  // Color code publish button\n  stylePublish(sk);\n}\n"],"names":["stylePublish","sk","style","CSSStyleSheet","replaceSync","shadowRoot","adoptedStyleSheets","setTimeout","btn","querySelector","insertAdjacentHTML","init","createTag","loadBlock","loadScript","loadStyle","sendToCaasListener","e","host","project","ref","branch","repo","owner","detail","data","config","Promise","resolve","then","sendToCaaS","reject","checkSchemaListener","schema","document","resultsUrl","window","open","encodeURIComponent","location","href","preflightListener","preflight","class","content","getModal","id","closeEvent","addEventListener"],"mappings":"AAAe,SAASA,YAAYA,CAACC,EAAE,EAAE;EACvC,MAAMC,KAAK,GAAG,IAAIC,aAAa,EAAE;EACjCD,KAAK,CAACE,WAAW,CAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,CAAC;EACFH,EAAE,CAACI,UAAU,CAACC,kBAAkB,GAAG,CAACJ,KAAK,CAAC;EAC1CK,UAAU,CAAC,MAAM;IACf,MAAMC,GAAG,GAAGP,EAAE,CAACI,UAAU,CAACI,aAAa,CAAC,wBAAwB,CAAC;IACjED,GAAG,EAAEE,kBAAkB,CAAC,WAAW,EAAE;AACzC;AACA,KAAK,CAAC;GACH,EAAE,GAAG,CAAC;AACT;;ACxDA;AACe,SAASC,IAAIA,CAAC;EAAEC,SAAS;EAAEC,SAAS;EAAEC,UAAU;EAAEC;AAAU,CAAC,EAAE;;EAE5E,MAAMC,kBAAkB,aAAUC,CAAC;IAAA,IAAK;MACtC,MAAM;QAAEC,IAAI;QAAEC,OAAO;QAAEC,GAAG,EAAEC,MAAM;QAAEC,IAAI;QAAEC;OAAO,GAAGN,CAAC,CAACO,MAAM,CAACC,IAAI,CAACC,MAAM;;MACxE,OAAAC,OAAA,CAAAC,OAAA,CAC6B,OAAO,2DAA2D,CAAC,EAAAC,IAAA,WAA1F;QAAEC;OAAY;QACpBA,UAAU,CAAC;UAAEZ,IAAI;UAAEC,OAAO;UAAEE,MAAM;UAAEC,IAAI;UAAEC;SAAO,EAAET,UAAU,EAAEC,SAAS,CAAC;;KAC1E,QAAAE,CAAA;MAAA,OAAAU,OAAA,CAAAI,MAAA,CAAAd,CAAA;;;EAED,MAAMe,mBAAmB;IAAA,IAAe;MACtC,MAAMC,MAAM,GAAGC,QAAQ,CAACzB,aAAa,CAAC,oCAAoC,CAAC;MAC3E,IAAIwB,MAAM,KAAK,IAAI,EAAE,OAAAN,OAAA,CAAAC,OAAA;MACrB,MAAMO,UAAU,GAAG,kDAAkD;MACrEC,MAAM,CAACC,IAAI,CAAC,GAAGF,UAAU,GAAGG,kBAAkB,CAACF,MAAM,CAACG,QAAQ,CAACC,IAAI,CAAC,EAAE,EAAE,cAAc,CAAC;MAAC,OAAAb,OAAA,CAAAC,OAAA;KACzF,QAAAX,CAAA;MAAA,OAAAU,OAAA,CAAAI,MAAA,CAAAd,CAAA;;;EAED,MAAMwB,iBAAiB;IAAA,IAAe;MACpC,MAAMC,SAAS,GAAG9B,SAAS,CAAC,KAAK,EAAE;QAAE+B,KAAK,EAAE;OAAa,CAAC;MAAC,OAAAhB,OAAA,CAAAC,OAAA,CACrCf,SAAS,CAAC6B,SAAS,CAAC,EAAAb,IAAA,WAApCe,OAAO;QAAA,OAAAjB,OAAA,CAAAC,OAAA,CAEc,OAAO,qBAA0B,CAAC,EAAAC,IAAA,WAAvD;UAAEgB;SAAU;UAClBA,QAAQ,CAAC,IAAI,EAAE;YAAEC,EAAE,EAAE,WAAW;YAAEF,OAAO;YAAEG,UAAU,EAAE;WAAc,CAAC;;;KACvE,QAAA9B,CAAA;MAAA,OAAAU,OAAA,CAAAI,MAAA,CAAAd,CAAA;;;;;EAGDiB,QAAQ,CAACc,gBAAgB,CAAC,cAAc,YAAS/B,CAAC;IAAA,IAAK;MACrD,MAAM;QAAEC,IAAI;QAAEC,OAAO;QAAEE,MAAM;QAAEC,IAAI;QAAEC;OAAO,GAAGN,CAAC,CAACO,MAAM;MAAC,OAAAG,OAAA,CAAAC,OAAA,CAC3B,OAAO,4BAA0C,CAAC,EAAAC,IAAA,WAAzE;QAAEC;OAAY;QACpBA,UAAU,CAAC;UAAEZ,IAAI;UAAEC,OAAO;UAAEE,MAAM;UAAEC,IAAI;UAAEC;SAAO,EAAET,UAAU,EAAEC,SAAS,CAAC;;KAC1E,QAAAE,CAAA;MAAA,OAAAU,OAAA,CAAAI,MAAA,CAAAd,CAAA;;IAAC;EAEF,MAAMhB,EAAE,GAAGiC,QAAQ,CAACzB,aAAa,CAAC,gBAAgB,CAAC;;;EAGnDR,EAAE,CAAC+C,gBAAgB,CAAC,qBAAqB,EAAEhC,kBAAkB,CAAC;EAC9Df,EAAE,CAAC+C,gBAAgB,CAAC,qBAAqB,EAAEhB,mBAAmB,CAAC;EAC/D/B,EAAE,CAAC+C,gBAAgB,CAAC,kBAAkB,EAAEP,iBAAiB,CAAC;;;EAG1DzC,YAAY,CAACC,EAAE,CAAC;AAClB;;;;"}