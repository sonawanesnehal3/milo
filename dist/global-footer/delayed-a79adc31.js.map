{"version":3,"file":"delayed-a79adc31.js","sources":["../../libs/scripts/delayed.js"],"sourcesContent":["/*\n * Copyright 2024 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nexport const loadJarvisChat = async (getConfig, getMetadata, loadScript, loadStyle) => {\n  const config = getConfig();\n  const jarvis = getMetadata('jarvis-chat')?.toLowerCase();\n  if (!jarvis || !['mobile', 'desktop', 'on'].includes(jarvis)\n    || !config.jarvis?.id || !config.jarvis?.version) return;\n\n  const desktopViewport = window.matchMedia('(min-width: 900px)').matches;\n  if (jarvis === 'mobile' && desktopViewport) return;\n  if (jarvis === 'desktop' && !desktopViewport) return;\n\n  const { initJarvisChat } = await import('../features/jarvis-chat.js');\n  initJarvisChat(config, loadScript, loadStyle, getMetadata);\n};\n\nexport const loadPrivacy = async (getConfig, loadScript) => {\n  const acom = '7a5eb705-95ed-4cc4-a11d-0cc5760e93db';\n  const ids = {\n    'hlx.page': '3a6a37fe-9e07-4aa9-8640-8f358a623271-test',\n    'hlx.live': '926b16ce-cc88-4c6a-af45-21749f3167f3-test',\n  };\n\n  const otDomainId = ids?.[Object.keys(ids)\n    .find((domainId) => window.location.host.includes(domainId))]\n      ?? (getConfig()?.privacyId || acom);\n  window.fedsConfig = {\n    privacy: { otDomainId },\n    documentLanguage: true,\n  };\n  loadScript('https://www.adobe.com/etc.clientlibs/globalnav/clientlibs/base/privacy-standalone.js');\n\n  // Privacy triggers can exist anywhere on the page and can be added at any time\n  document.addEventListener('click', (event) => {\n    if (event.target.closest('a[href*=\"#openPrivacy\"]')) {\n      event.preventDefault();\n      window.adobePrivacy?.showPreferenceCenter();\n    }\n  });\n};\n\nexport const loadGoogleLogin = async (getMetadata, loadIms, loadScript) => {\n  const googleLogin = getMetadata('google-login')?.toLowerCase();\n  if (window.adobeIMS?.isSignedInUser() || !['mobile', 'desktop', 'on'].includes(googleLogin)) return;\n  const desktopViewport = window.matchMedia('(min-width: 900px)').matches;\n  if (googleLogin === 'mobile' && desktopViewport) return;\n  if (googleLogin === 'desktop' && !desktopViewport) return;\n\n  const { default: initGoogleLogin } = await import('../features/google-login.js');\n  initGoogleLogin(loadIms, getMetadata, loadScript);\n};\n\n/**\n * Executes everything that happens a lot later, without impacting the user experience.\n */\nconst loadDelayed = ([\n  getConfig,\n  getMetadata,\n  loadScript,\n  loadStyle,\n  loadIms,\n], DELAY = 3000) => new Promise((resolve) => {\n  setTimeout(() => {\n    loadPrivacy(getConfig, loadScript);\n    loadJarvisChat(getConfig, getMetadata, loadScript, loadStyle);\n    loadGoogleLogin(getMetadata, loadIms, loadScript);\n    if (getMetadata('interlinks') === 'on') {\n      const { locale } = getConfig();\n      const path = `${locale.contentRoot}/keywords.json`;\n      const language = locale.ietf?.split('-')[0];\n      import('../features/interlinks.js').then((mod) => { mod.default(path, language); resolve(mod); });\n    } else {\n      resolve(null);\n    }\n    import('../utils/samplerum.js').then(({ sampleRUM }) => sampleRUM('cwv'));\n  }, DELAY);\n});\n\nexport default loadDelayed;\n"],"names":["loadJarvisChat","getConfig","getMetadata","loadScript","loadStyle","config","jarvis","toLowerCase","includes","id","version","Promise","resolve","desktopViewport","window","matchMedia","matches","then","initJarvisChat","e","reject","loadPrivacy","acom","ids","otDomainId","Object","keys","find","domainId","location","host","privacyId","fedsConfig","privacy","documentLanguage","document","addEventListener","event","target","closest","preventDefault","adobePrivacy","showPreferenceCenter","loadGoogleLogin","loadIms","googleLogin","adobeIMS","isSignedInUser","default","initGoogleLogin","loadDelayed","DELAY","setTimeout","locale","path","contentRoot","language","ietf","split","mod","sampleRUM"],"mappings":"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"}