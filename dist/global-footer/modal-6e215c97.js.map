{"version":3,"file":"modal-6e215c97.js","sources":["../../libs/blocks/modal/modal.js"],"sourcesContent":["/* eslint-disable import/no-cycle */\nimport { createTag, getMetadata, localizeLink, loadStyle, getConfig } from '../../utils/utils.js';\n\nconst FOCUSABLES = 'a:not(.hide-video), button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"]';\nconst CLOSE_ICON = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <g transform=\"translate(-10500 3403)\">\n    <circle cx=\"10\" cy=\"10\" r=\"10\" transform=\"translate(10500 -3403)\" fill=\"#707070\"/>\n    <line y1=\"8\" x2=\"8\" transform=\"translate(10506 -3397)\" fill=\"none\" stroke=\"#fff\" stroke-width=\"2\"/>\n    <line x1=\"8\" y1=\"8\" transform=\"translate(10506 -3397)\" fill=\"none\" stroke=\"#fff\" stroke-width=\"2\"/>\n  </g>\n</svg>`;\n\nlet isDelayedModal = false;\n\nexport function findDetails(hash, el) {\n  const id = hash.replace('#', '');\n  const a = el || document.querySelector(`a[data-modal-hash=\"${hash}\"]`);\n  const path = a?.dataset.modalPath || localizeLink(getMetadata(`-${id}`));\n  return { id, path, isHash: hash === window.location.hash };\n}\n\nexport function sendAnalytics(event) {\n  // eslint-disable-next-line no-underscore-dangle\n  window._satellite?.track('event', {\n    xdm: {},\n    data: {\n      web: { webInteraction: { name: event?.type } },\n      _adobe_corpnew: { digitalData: event?.data },\n    },\n  });\n}\n\nexport function closeModal(modal) {\n  const { id } = modal;\n  const closeEvent = new Event('milo:modal:closed');\n  window.dispatchEvent(closeEvent);\n\n  document.querySelectorAll(`#${id}`).forEach((mod) => {\n    if (mod.classList.contains('dialog-modal')) {\n      const modalCurtain = document.querySelector(`#${id}~.modal-curtain`);\n      if (modalCurtain) {\n        modalCurtain.remove();\n      }\n      mod.remove();\n    }\n    document.querySelector(`[data-modal-hash=\"#${mod.id}\"]`)?.focus();\n  });\n\n  if (!document.querySelectorAll('.modal-curtain').length) {\n    document.body.classList.remove('disable-scroll');\n  }\n\n  [...document.querySelectorAll('header, main, footer')]\n    .forEach((element) => element.removeAttribute('aria-disabled'));\n\n  const hashId = window.location.hash.replace('#', '');\n  if (hashId === modal.id) window.history.pushState('', document.title, `${window.location.pathname}${window.location.search}`);\n  isDelayedModal = false;\n}\n\nfunction isElementInView(element) {\n  const rect = element.getBoundingClientRect();\n  return (\n    rect.top >= 0\n    && rect.left >= 0\n    && rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n    && rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n\nfunction getCustomModal(custom, dialog) {\n  const { miloLibs, codeRoot } = getConfig();\n  loadStyle(`${miloLibs || codeRoot}/blocks/modal/modal.css`);\n  if (custom.id) dialog.id = custom.id;\n  if (custom.class) dialog.classList.add(custom.class);\n  if (custom.closeEvent) {\n    dialog.addEventListener(custom.closeEvent, () => {\n      closeModal(dialog);\n    });\n  }\n  dialog.append(custom.content);\n}\n\nasync function getPathModal(path, dialog) {\n  const block = createTag('a', { href: path });\n  dialog.append(block);\n\n  // eslint-disable-next-line import/no-cycle\n  const { default: getFragment } = await import('../fragment/fragment.js');\n  await getFragment(block);\n}\n\nexport async function getModal(details, custom) {\n  if (!(details?.path || custom)) return null;\n  const { id } = details || custom;\n\n  const dialog = createTag('div', { class: 'dialog-modal', id });\n  const loadedEvent = new Event('milo:modal:loaded');\n\n  if (custom) getCustomModal(custom, dialog);\n  if (details) await getPathModal(details.path, dialog);\n  if (isDelayedModal) {\n    dialog.classList.add('delayed-modal');\n    const mediaBlock = dialog.querySelector('div.media');\n    if (mediaBlock) {\n      mediaBlock.classList.add('in-modal');\n      const { miloLibs, codeRoot } = getConfig();\n      const base = miloLibs || codeRoot;\n      loadStyle(`${base}/styles/rounded-corners.css`);\n    }\n  }\n\n  const localeModal = id?.includes('locale-modal') ? 'localeModal' : 'milo';\n  const analyticsEventName = window.location.hash ? window.location.hash.replace('#', '') : localeModal;\n  const close = createTag('button', {\n    class: 'dialog-close',\n    'aria-label': 'Close',\n    'daa-ll': `${analyticsEventName}:modalClose:buttonClose`,\n  }, CLOSE_ICON);\n\n  const focusVisible = { focusVisible: true };\n  const focusablesOnLoad = [...dialog.querySelectorAll(FOCUSABLES)];\n  const titleOnLoad = dialog.querySelector('h1, h2, h3, h4, h5');\n  let firstFocusable;\n\n  if (focusablesOnLoad.length && isElementInView(focusablesOnLoad[0])) {\n    firstFocusable = focusablesOnLoad[0]; // eslint-disable-line prefer-destructuring\n  } else if (titleOnLoad) {\n    titleOnLoad.setAttribute('tabIndex', 0);\n    firstFocusable = titleOnLoad;\n  } else {\n    firstFocusable = close;\n  }\n\n  dialog.addEventListener('keydown', (event) => {\n    const isShiftKey = event.shiftKey;\n    const isTab = event.key === 'Tab';\n    const isCloseActive = document.activeElement === close;\n\n    if (!isShiftKey && isTab && isCloseActive) {\n      event.preventDefault();\n      firstFocusable.focus(focusVisible);\n    }\n\n    if (isTab && isShiftKey && document.activeElement === firstFocusable) {\n      event.preventDefault();\n      close.focus(focusVisible);\n    }\n  });\n\n  close.addEventListener('click', (e) => {\n    closeModal(dialog);\n    e.preventDefault();\n  });\n\n  dialog.addEventListener('keydown', (event) => {\n    if (event.key === 'Escape') {\n      closeModal(dialog);\n    }\n  });\n\n  dialog.append(close);\n  document.body.append(dialog);\n  firstFocusable.focus({ preventScroll: true, ...focusVisible });\n  window.dispatchEvent(loadedEvent);\n\n  if (!dialog.classList.contains('curtain-off')) {\n    document.body.classList.add('disable-scroll');\n    const curtain = createTag('div', { class: 'modal-curtain is-open' });\n    curtain.addEventListener('click', (e) => {\n      if (e.target === curtain) closeModal(dialog);\n    });\n    dialog.insertAdjacentElement('afterend', curtain);\n    [...document.querySelectorAll('header, main, footer')]\n      .forEach((element) => element.setAttribute('aria-disabled', 'true'));\n  }\n\n  const iframe = dialog.querySelector('iframe');\n  if (iframe) {\n    if (dialog.classList.contains('commerce-frame')) {\n      const { default: enableCommerceFrameFeatures } = await import('./modal.merch.js');\n      await enableCommerceFrameFeatures({ dialog, iframe });\n    } else {\n      /* Initially iframe height is set to 0% in CSS for the height auto adjustment feature.\n      For modals without the 'commerce-frame' class height auto adjustment is not applicable */\n      iframe.style.height = '100%';\n    }\n  }\n\n  return dialog;\n}\n\nexport function getHashParams(hashStr) {\n  if (!hashStr) return {};\n  return hashStr.split(':').reduce((params, part) => {\n    if (part.startsWith('#')) {\n      params.hash = part;\n    } else {\n      const [key, val] = part.split('=');\n      if (key === 'delay' && parseInt(val, 10) > 0) {\n        params.delay = parseInt(val, 10) * 1000;\n      }\n    }\n    return params;\n  }, {});\n}\n\nexport function delayedModal(el) {\n  const { hash, delay } = getHashParams(el?.dataset.modalHash);\n  if (!delay || !hash) return false;\n  isDelayedModal = true;\n  el.classList.add('hide-block');\n  const modalOpenEvent = new Event(`${hash}:modalOpen`);\n  const pagesModalWasShownOn = window.sessionStorage.getItem(`shown:${hash}`);\n  el.dataset.modalHash = hash;\n  el.href = hash;\n  if (!pagesModalWasShownOn?.includes(window.location.pathname)) {\n    setTimeout(() => {\n      window.location.replace(hash);\n      sendAnalytics(modalOpenEvent);\n      window.sessionStorage.setItem(`shown:${hash}`, `${pagesModalWasShownOn || ''} ${window.location.pathname}`);\n    }, delay);\n  }\n  return true;\n}\n\n// Deep link-based\nexport default function init(el) {\n  const { modalHash } = el.dataset;\n  if (delayedModal(el) || window.location.hash !== modalHash || document.querySelector(`div.dialog-modal${modalHash}`)) return null;\n  const details = findDetails(window.location.hash, el);\n  return details ? getModal(details) : null;\n}\n\n// Click-based modal\nwindow.addEventListener('hashchange', (e) => {\n  if (!window.location.hash) {\n    try {\n      const url = new URL(e.oldURL);\n      const dialog = document.querySelector(`.dialog-modal${url.hash}`);\n      if (dialog) closeModal(dialog);\n    } catch (error) {\n      /* do nothing */\n    }\n  } else {\n    const details = findDetails(window.location.hash, null);\n    if (details) getModal(details);\n  }\n});\n"],"names":["getModal","details","custom","_temp4","isDelayedModal","dialog","classList","add","mediaBlock","querySelector","miloLibs","codeRoot","getConfig","base","loadStyle","localeModal","id","includes","analyticsEventName","window","location","hash","replace","close","createTag","class","CLOSE_ICON","focusVisible","focusablesOnLoad","querySelectorAll","FOCUSABLES","titleOnLoad","firstFocusable","length","isElementInView","setAttribute","addEventListener","event","isShiftKey","shiftKey","isTab","key","isCloseActive","document","activeElement","preventDefault","focus","e","closeModal","append","body","preventScroll","dispatchEvent","loadedEvent","contains","curtain","target","insertAdjacentElement","forEach","element","iframe","_temp2","_temp","Promise","resolve","then","default","enableCommerceFrameFeatures","style","height","path","Event","getCustomModal","_temp3","getPathModal","reject","block","href","getFragment","findDetails","el","a","dataset","modalPath","localizeLink","getMetadata","isHash","sendAnalytics","_satellite","track","xdm","data","web","webInteraction","name","type","_adobe_corpnew","digitalData","modal","closeEvent","mod","modalCurtain","remove","removeAttribute","hashId","history","pushState","title","pathname","search","rect","getBoundingClientRect","top","left","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","content","getHashParams","hashStr","split","reduce","params","part","startsWith","val","parseInt","delay","delayedModal","modalHash","modalOpenEvent","pagesModalWasShownOn","sessionStorage","getItem","setTimeout","setItem","init","url","URL","oldURL","error"],"mappings":"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"}